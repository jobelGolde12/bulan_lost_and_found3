import{_ as U,r as d,j as $,y as F,z as M,c as r,o as n,b as i,F as P,s as z,J as D,a as h,w,h as N,t as l,u as y,P as b,n as k}from"./app-BB0yyVeW.js";const B={class:"card-grid"},E={key:0,class:"empty-state"},j={key:1,class:"card-grid__container"},H={class:"item-card__image-container"},S=["src","alt"],x={class:"item-card__image-overlay"},J={class:"item-card__date"},R={class:"item-card__content"},T={class:"item-card__details"},Y={class:"item-card__title"},q=["title"],G={class:"item-card__category"},K={class:"item-card__footer"},O={class:"user-info__avatar"},Q=["src","alt"],W={class:"user-info__name"},X=["disabled","title","onClick"],Z={key:1,class:"bi bi-arrow-repeat",style:{animation:"spin 0.8s linear infinite"}},ee={__name:"ItemCardForAdmin",props:{items:{type:Array,default:()=>[]}},setup(L){const A=L,c=d([]),u=d(1),f=d(!0),m=d(!1);$(()=>A.items,s=>{c.value=s.map(t=>{var e;return{...t,isViewLater:!!((e=t.view_later)!=null&&e.some(o=>o.item_id===t.id)),isLoading:!1}})},{immediate:!0});const C=async()=>{if(!(!f.value||m.value)){m.value=!0,u.value++;try{const s=await D.get(`/admin/items/load-more?page=${u.value}`),{items:t,hasMore:e}=s.data;c.value.push(...t.map(o=>{var a;return{...o,isViewLater:!!((a=o.view_later)!=null&&a.some(_=>_.item_id===o.id)),isLoading:!1}})),f.value=e}finally{m.value=!1}}},g=()=>{window.innerHeight+window.scrollY>=document.body.offsetHeight-50&&C()},I=s=>{if(!s)return"";const t={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString(void 0,t)},V=(s,t=20)=>s?s.length>t?`${s.slice(0,t)}...`:s:"";return F(()=>window.addEventListener("scroll",g)),M(()=>window.removeEventListener("scroll",g)),(s,t)=>(n(),r("div",B,[c.value.length===0?(n(),r("div",E,t[0]||(t[0]=[i("i",{class:"bi bi-inbox empty-state__icon"},null,-1),i("p",{class:"empty-state__text"},"No items found",-1)]))):(n(),r("div",j,[(n(!0),r(P,null,z(c.value,e=>{var o;return n(),r("article",{key:e.id,class:"item-card"},[h(y(b),{href:s.route("viewItemInfoAsAdmin",{item:e==null?void 0:e.id}),class:"item-card__image-link"},{default:w(()=>[i("div",H,[e.image_url?(n(),r("img",{key:0,src:e.image_url,alt:`Image of ${e.title}`,class:"item-card__image",loading:"lazy"},null,8,S)):N("",!0),i("div",x,[i("time",J,l(I(e==null?void 0:e.created_at)),1)])])]),_:2},1032,["href"]),i("div",R,[i("div",T,[i("h3",Y,l(e.title||"Untitled"),1),i("p",{class:"item-card__description",title:e.description},l(V(e.description,25)),9,q),i("span",G,l(e.category||"Uncategorized"),1)]),i("div",K,[h(y(b),{href:s.route("viewUserAsAdmin",{id:(o=e==null?void 0:e.user)==null?void 0:o.id}),class:"user-info"},{default:w(()=>{var a,_,p,v;return[i("div",O,[i("img",{src:(_=(a=e.user)==null?void 0:a.user_info)!=null&&_.profile_pic?`/storage/${e.user.user_info.profile_pic}`:"/images/profile.jpeg",alt:`Profile of ${(p=e.user)==null?void 0:p.name}`,class:"user-info__image"},null,8,Q)]),i("span",W,l(((v=e.user)==null?void 0:v.name)||"Unknown User"),1)]}),_:2},1032,["href"]),i("button",{class:k(["item-card__action",{"item-card__action--active":e.isViewLater}]),disabled:e.isLoading,title:e.isViewLater?"Remove from view later":"Add to view later",onClick:a=>s.viewLaterFunc(e.id)},[e.isLoading?(n(),r("i",Z)):(n(),r("i",{key:0,class:k(["bi",e.isViewLater?"bi-bookmark-fill":"bi-bookmark"])},null,2))],10,X)])])])}),128))])),t[1]||(t[1]=i("div",{class:"bottom-spacer"},null,-1))]))}},ie=U(ee,[["__scopeId","data-v-b92370d4"]]);export{ie as I};
