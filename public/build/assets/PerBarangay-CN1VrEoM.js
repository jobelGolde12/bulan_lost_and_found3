import{_ as J,r as u,c as i,o,b as t,g as A,t as r,e as R,u as Y,F as Q,s as G,h as $,J as Z,W as tt,j as z,l as C,k as st,A as nt,n as I,f as at}from"./app-CkqW5iWM.js";const lt={class:"view-barangay-container"},et={class:"content"},ot={class:"stats-grid"},rt={class:"table-section"},it={key:0,class:"info-section loading"},ut={key:1,class:"info-section redirecting"},dt={key:2,class:"info-section"},ct={key:3,class:"info-section"},vt={key:4,class:"items-table"},bt={key:0},gt={key:1},yt=["onClick"],ft=["onClick"],pt=["onClick"],kt={__name:"ViewBarangay",props:{barangay:String,data:Object},setup(B){const V=B,h=u([]),v=u(!1),L=u(!1);let b=u("Lost");const _=u(!1),g=u({}),k=u({}),T=e=>{_.value=!0,setTimeout(()=>{tt.visit(route("viewItemInfoAsAdmin",{item:e}))},800)},E=async e=>{try{L.value=!0,v.value=!0;const l=await Z.get(route("barangay.items"),{params:{barangay:V.barangay,status:e}});b.value=e,h.value=l.data}catch(l){console.error("Error fetching items:",l)}finally{L.value=!1}},O=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=(e,l,F)=>{if(!e)return"";const c=e.split(" ");return F||c.length<=l?e:c.slice(0,l).join(" ")+"..."},N=(e,l)=>e?e.split(" ").length>l:!1,S=(e,l)=>{e==="title"?g.value[l]=!g.value[l]:e==="desc"&&(k.value[l]=!k.value[l])};return(e,l)=>{var F,c;return o(),i("div",lt,[t("div",et,[t("div",ot,[t("button",{onClick:l[0]||(l[0]=A(d=>E("Lost"),["prevent"])),class:"stat-card lost"},[t("h3",null,r((F=B.data)==null?void 0:F.Lost),1),l[2]||(l[2]=t("p",null,"Lost Items",-1))]),t("button",{onClick:l[1]||(l[1]=A(d=>E("Found"),["prevent"])),class:"stat-card found"},[t("h3",null,r((c=B.data)==null?void 0:c.Found),1),l[3]||(l[3]=t("p",null,"Found Items",-1))])])]),t("div",rt,[L.value?(o(),i("div",it," Fetching reports, please wait... ")):_.value?(o(),i("div",ut," Redirecting to Reports Page... ")):v.value?v.value&&h.value.length===0?(o(),i("div",ct," No items found for this category in "+r(B.barangay)+". ",1)):(o(),i("table",vt,[t("thead",null,[t("tr",null,[l[5]||(l[5]=t("th",null,"Title",-1)),l[6]||(l[6]=t("th",null,"Category",-1)),l[7]||(l[7]=t("th",null,"Description",-1)),l[8]||(l[8]=t("th",null,"Location",-1)),l[9]||(l[9]=t("th",null,"Contact",-1)),t("th",null,[Y(b)==="Lost"?(o(),i("span",bt,"Lost at")):(o(),i("span",gt,"Found at"))])])]),t("tbody",null,[(o(!0),i(Q,null,G(h.value,(d,m)=>(o(),i("tr",{key:m,onClick:D=>T(d.id),class:"clickable-row"},[t("td",null,[t("span",null,r(j(d.title,7,g.value[m])),1),N(d.title,7)?(o(),i("button",{key:0,onClick:A(D=>S("title",m),["stop"]),class:"toggle-btn"},r(g.value[m]?"less":"more"),9,ft)):$("",!0)]),t("td",null,r(d.category),1),t("td",null,[t("span",null,r(j(d.description,7,k.value[m])),1),N(d.description,7)?(o(),i("button",{key:0,onClick:A(D=>S("desc",m),["stop"]),class:"toggle-btn text-success"},r(k.value[m]?" ...show less":" ...show more"),9,pt)):$("",!0)]),t("td",null,r(d.location),1),t("td",null,r(d.owner_phone_number||"N/A"),1),t("td",null,r(O(d.reported_at)),1)],8,yt))),128))])])):(o(),i("div",dt,l[4]||(l[4]=[R(" Please click "),t("b",null,"Lost Items",-1),R(" or "),t("b",null,"Found Items",-1),R(" to view reports. ")])))])])}}},mt=J(kt,[["__scopeId","data-v-82aab524"]]),Ct={class:"dashboard-container1 container-fluid"},ht={class:"controls-section"},Lt={class:"search-container"},Ft={class:"search-wrapper"},wt={class:"filters-container"},$t={class:"filter-buttons-group"},Bt={key:0,class:"barangay-filters"},_t={class:"stats-cards"},Tt={class:"stat-card total"},jt={class:"stat-content"},St={class:"stat-card lost"},It={class:"stat-content"},Ot={class:"stat-card found"},Dt={class:"stat-content"},Mt={class:"stat-card barangays"},At={class:"stat-content"},Et={class:"summary-section"},Nt={class:"table-container"},Rt={class:"modern-table"},Vt=["onClick"],xt={class:"barangay-cell"},Ut={class:"count-badge lost"},Pt={class:"count-badge found"},Wt={class:"count-badge total"},qt={key:0,class:"load-more-container"},zt={key:0,class:"empty-state"},Jt={class:"modal-container"},Qt={class:"modal-header"},Gt={class:"modal-body"},Ht={__name:"PerBarangay",props:{items:{type:Array,default:()=>[]}},setup(B){const V=B,h=u([]),v=u(""),L=u(""),b=u(""),_=u(!1),g=u("barangay"),k=u("asc"),T=u(0),E=n=>{if(!n)return"Unknown";const s=n.match(/^(.+?)(?:\s\([^(]*\))?$/);return s&&s[1]?s[1].trim():n.trim()};z(()=>V.items,n=>{h.value=n.map(s=>({...s,barangay:E(s.location)}))},{immediate:!0});const O=n=>v.value=n,j=n=>b.value=b.value===n?"":n,N=()=>_.value=!_.value,S=n=>{g.value===n?k.value=k.value==="asc"?"desc":"asc":(g.value=n,k.value="asc")},e=C(()=>{const n=L.value.toLowerCase();let s=h.value.filter(a=>{var p,w,q;const y=!v.value||a.status===v.value,f=((p=a==null?void 0:a.title)==null?void 0:p.toLowerCase().includes(n))||((w=a==null?void 0:a.barangay)==null?void 0:w.toLowerCase().includes(n))||((q=a==null?void 0:a.status)==null?void 0:q.toLowerCase().includes(n));return y&&f});if(b.value){const a=l.value,y=Object.entries(a).sort(([,f],[,p])=>b.value==="mostLost"?p.Lost-f.Lost:b.value==="mostFound"?p.Found-f.Found:0).slice(0,5).map(([f])=>f);s=s.filter(f=>y.includes(f.barangay))}return s}),l=C(()=>{const n={};return h.value.forEach(s=>{const a=s.barangay||"Unknown";n[a]||(n[a]={Lost:0,Found:0,Total:0}),s.status==="Lost"&&n[a].Lost++,s.status==="Found"&&n[a].Found++,n[a].Total++}),n}),F=C(()=>{const n={};if(e.value.forEach(s=>{const a=s.barangay||"Unknown";n[a]||(n[a]={Lost:0,Found:0,Total:0}),s.status==="Lost"&&n[a].Lost++,s.status==="Found"&&n[a].Found++,n[a].Total++}),v.value==="")for(const s in n)n[s].Lost===0&&n[s].Found===0&&delete n[s];return n}),c=C(()=>Object.entries(F.value).sort(([s,a],[y,f])=>{const p=g.value==="barangay"?s.toLowerCase():a[g.value],w=g.value==="barangay"?y.toLowerCase():f[g.value];return k.value==="asc"?p<w?-1:p>w?1:0:p>w?-1:p<w?1:0}).reduce((s,[a,y])=>(s[a]=y,s),{}));z(c,n=>{const s=Object.keys(n).length;T.value=Math.ceil(s/2)},{immediate:!0});const d=()=>{T.value=Object.keys(c.value).length},m=C(()=>{const n=Object.entries(c.value).slice(0,T.value);return Object.fromEntries(n)}),D=C(()=>e.value.filter(n=>n.status==="Lost").length),U=C(()=>e.value.filter(n=>n.status==="Found").length),H=C(()=>Object.keys(F.value).length),M=u(!1),x=u(""),P=u(null);function K(n){x.value=n,P.value=c.value[n],M.value=!0}function W(){M.value=!1}const X=C(()=>D.value+U.value);return(n,s)=>(o(),i("div",Ct,[s[32]||(s[32]=t("div",{class:"dashboard-header"},[t("div",{class:"header-content"},[t("h1",{class:"dashboard-title"},"Barangay Overview")])],-1)),t("div",ht,[t("div",Lt,[t("div",Ft,[s[11]||(s[11]=t("i",{class:"bi bi-search search-icon"},null,-1)),st(t("input",{type:"text",class:"search-input",placeholder:"Search...","onUpdate:modelValue":s[0]||(s[0]=a=>L.value=a)},null,512),[[nt,L.value]]),t("div",{class:"search-actions"},[t("i",{class:"bi bi-funnel-fill filter-icon",onClick:N})])])]),t("div",wt,[t("div",$t,[t("button",{class:I(["filter-btn",{active:v.value===""}]),onClick:s[1]||(s[1]=a=>O(""))},s[12]||(s[12]=[t("i",{class:"bi bi-grid-3x3-gap-fill"},null,-1),t("span",null,"All",-1)]),2),t("button",{class:I(["filter-btn lost",{active:v.value==="Lost"}]),onClick:s[2]||(s[2]=a=>O("Lost"))},s[13]||(s[13]=[t("i",{class:"bi bi-search"},null,-1),t("span",null,"Lost",-1)]),2),t("button",{class:I(["filter-btn found",{active:v.value==="Found"}]),onClick:s[3]||(s[3]=a=>O("Found"))},s[14]||(s[14]=[t("i",{class:"bi bi-check-circle"},null,-1),t("span",null,"Found",-1)]),2)]),_.value?(o(),i("div",Bt,[t("button",{class:I(["barangay-filter-btn",{active:b.value==="mostLost"}]),onClick:s[4]||(s[4]=a=>j("mostLost"))},s[15]||(s[15]=[t("i",{class:"bi bi-exclamation-triangle"},null,-1),t("span",null,"Most Lost",-1)]),2),t("button",{class:I(["barangay-filter-btn",{active:b.value==="mostFound"}]),onClick:s[5]||(s[5]=a=>j("mostFound"))},s[16]||(s[16]=[t("i",{class:"bi bi-check-square"},null,-1),t("span",null,"Most Found",-1)]),2),t("button",{class:I(["barangay-filter-btn",{active:b.value===""}]),onClick:s[6]||(s[6]=a=>j(""))},s[17]||(s[17]=[t("i",{class:"bi bi-x-circle"},null,-1),t("span",null,"Clear",-1)]),2)])):$("",!0)])]),t("div",_t,[t("div",Tt,[s[19]||(s[19]=t("div",{class:"stat-icon"},[t("i",{class:"bi bi-clipboard-data"})],-1)),t("div",jt,[t("h3",null,r(X.value),1),s[18]||(s[18]=t("p",null,"Total Reports",-1))])]),t("div",St,[s[21]||(s[21]=t("div",{class:"stat-icon"},[t("i",{class:"bi bi-search"})],-1)),t("div",It,[t("h3",null,r(D.value),1),s[20]||(s[20]=t("p",null,"Lost Items",-1))])]),t("div",Ot,[s[23]||(s[23]=t("div",{class:"stat-icon"},[t("i",{class:"bi bi-check-circle"})],-1)),t("div",Dt,[t("h3",null,r(U.value),1),s[22]||(s[22]=t("p",null,"Found Items",-1))])]),t("div",Mt,[s[25]||(s[25]=t("div",{class:"stat-icon"},[t("i",{class:"bi bi-geo-alt"})],-1)),t("div",At,[t("h3",null,r(H.value),1),s[24]||(s[24]=t("p",null,"Barangays",-1))])])]),t("div",Et,[t("div",Nt,[t("table",Rt,[t("thead",null,[t("tr",null,[t("th",{onClick:s[7]||(s[7]=a=>S("barangay")),class:"sortable"},s[26]||(s[26]=[t("span",null,"Barangay",-1),t("i",{class:"bi bi-arrow-down-up sort-icon"},null,-1)])),t("th",{onClick:s[8]||(s[8]=a=>S("Lost")),class:"sortable"},s[27]||(s[27]=[t("span",null,"Lost",-1),t("i",{class:"bi bi-arrow-down-up sort-icon"},null,-1)])),t("th",{onClick:s[9]||(s[9]=a=>S("Found")),class:"sortable"},s[28]||(s[28]=[t("span",null,"Found",-1),t("i",{class:"bi bi-arrow-down-up sort-icon"},null,-1)])),s[29]||(s[29]=t("th",{class:"sortable"},[t("span",null,"Total")],-1))])]),t("tbody",null,[(o(!0),i(Q,null,G(m.value,(a,y)=>(o(),i("tr",{key:y,class:"table-row",onClick:f=>K(y)},[t("td",xt,[s[30]||(s[30]=t("i",{class:"bi bi-geo-alt-fill barangay-icon"},null,-1)),R(" "+r(y),1)]),t("td",null,[t("span",Ut,r(a.Lost),1)]),t("td",null,[t("span",Pt,r(a.Found),1)]),t("td",null,[t("span",Wt,r(a.Lost+a.Found),1)])],8,Vt))),128))])]),T.value<Object.keys(c.value).length?(o(),i("div",qt,[t("button",{class:"load-more-btn",onClick:d},"Load More")])):$("",!0)]),Object.keys(c.value).length===0?(o(),i("div",zt,s[31]||(s[31]=[t("i",{class:"bi bi-inbox empty-icon"},null,-1),t("h3",null,"No reports found",-1),t("p",null,"Try adjusting your search or filters",-1)]))):$("",!0)]),M.value?(o(),i("div",{key:0,class:"modal-overlay",onClick:A(W,["self"])},[t("div",Jt,[t("div",Qt,[t("h2",null,r(x.value),1),t("button",{class:"close-btn",onClick:W},"Ã—")]),t("div",Gt,[M.value?(o(),at(mt,{key:0,barangay:x.value,data:P.value,onClose:s[10]||(s[10]=a=>M.value=!1)},null,8,["barangay","data"])):$("",!0)])])])):$("",!0)]))}},Xt=J(Ht,[["__scopeId","data-v-cb39eff2"]]);export{Xt as default};
