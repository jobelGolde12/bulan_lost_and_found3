import{_ as R,x as B,r as c,y as W,G as H,c as a,o as r,b as e,a as y,w as N,t as d,u as v,P as L,h as b,e as g,W as z,j as I,C as G,ai as T,m as q,I as U,n as j,g as J,k as M,A as K,F as E,s as Q}from"./app-BVOfK1M-.js";/* empty css                                                                    */import{A as X}from"./AuthenticatedLayout-X_qQ-WKP.js";import{d as Y}from"./index-BEMHGnw0.js";import{d as Z}from"./downloadAsPDF-DEr5fmes.js";import"./lost_and_found_logo-Bi2rL7qL.js";/* empty css                                                                     */import"./index-09AjRV5V.js";const ee={class:"container-fluid d-column flex-row align-items-center px-0"},te={class:"mb-2 container-fluid px-0 d-flex flex-row justify-content-between align-items-center"},se=["src"],oe={class:"text-sm font-medium text-gray-700"},le={class:"flex justify-between items-center mb-4 header"},ne={class:"d-flex flex-column"},ie={class:"text-xl font-semibold mb-0"},ae={class:"description"},re={class:"modal fade",id:"downloadAsPDF",tabindex:"-1","aria-labelledby":"addNewMemberLabel","aria-hidden":"true"},de={class:"modal-dialog modal-lg"},ce={class:"modal-content"},ue={class:"modal-body"},me={__name:"ViewItemInfoHeader",props:{created_by:Object,getProfile:String,data:Object,title:String,description:String},setup(P){const m=B(),i=P,o=c(!1),h=c(null),n=c(null),V=()=>{o.value=!o.value},_=u=>{h.value&&!h.value.contains(u.target)&&n.value&&!n.value.contains(u.target)&&(o.value=!1)};W(()=>{document.addEventListener("click",_)}),H(()=>{document.removeEventListener("click",_)});const f=c(!1);c("Generating PDF, please wait...");const A=c(null),D=async()=>{try{f.value=!0,await A.value.downloadPdf()}catch(u){console.error(u),alert("PDF download failed!")}finally{f.value=!1}},x=()=>{var u;confirm("Are you sure you want to delete this item? ")&&z.delete(route("forceDeleteItem",{id:(u=i==null?void 0:i.data)==null?void 0:u.id}),{},{onSuccess:()=>alert("Item deleted."),onError:()=>alert("An error occurred, please try again.")})};return(u,p)=>{var $,w,k;return r(),a("div",null,[e("div",ee,[e("div",te,[e("div",null,[y(v(L),{href:u.route("view.userAsUser",{id:($=i.created_by)==null?void 0:$.id}),class:"text-decoration-none d-flex align-items-center gap-2"},{default:N(()=>{var s;return[e("img",{src:i.getProfile=="NA"?"../../images/profile.jpeg":`/storage/${i.getProfile}`,alt:"User",class:"profile-pic"},null,8,se),e("span",oe,d((s=i.created_by)==null?void 0:s.name),1)]}),_:1},8,["href"])]),e("div",{ref_key:"iconRef",ref:n,class:"position-relative"},[e("i",{class:"bi bi-three-dots-vertical action",onClick:V}),o.value?(r(),a("div",{key:0,ref_key:"popupRef",ref:h,class:"position-absolute bg-white border shadow-sm rounded d-flex flex-column",style:{right:"0",top:"100%","z-index":"999","min-width":"180px"}},[y(v(L),{href:u.route("message.admin"),class:"button text-decoration-none text-dark"},{default:N(()=>p[0]||(p[0]=[g(" Contact Admin ")])),_:1},8,["href"]),p[1]||(p[1]=e("button",{class:"button","data-bs-toggle":"modal","data-bs-target":"#downloadAsPDF"}," Download as PDF ",-1)),((w=v(m).props.auth)==null?void 0:w.user.id)===((k=i.created_by)==null?void 0:k.id)?(r(),a("button",{key:0,class:"button",onClick:x,title:"Note! only if the user didn't follow the privacy and policy."},"Delete Post")):b("",!0)],512)):b("",!0)],512)]),e("div",le,[e("div",ne,[e("h2",ie,d(i.title||"Unnamed Item"),1),e("p",ae,d(i.description||"No description"),1)])]),e("div",re,[e("div",de,[e("div",ce,[e("div",ue,[y(Z,{ref_key:"pdfRef",ref:A,item:i==null?void 0:i.data},null,8,["item"])]),e("div",{class:"modal-footer"},[p[2]||(p[2]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:D}," Download now ")])])])])])])}}},_e=R(me,[["__scopeId","data-v-e1273049"]]),fe={class:"main-container"},ve={class:"container"},pe={class:"post-container rounded-lg shadow-md w-full max-w-3xl p-6"},be={key:0},ge=["src"],ye={key:0,class:"absolute inset-0 bg-black bg-opacity-50 text-white font-semibold transition-opacity duration-300 flex items-center justify-center rounded","data-bs-toggle":"modal","data-bs-target":"#fullView"},he={class:"text-end date"},xe={class:"text-sm text-gray-700 space-y-1 d-none d-lg-block"},we={class:"mb-0"},ke={key:0},Ie={class:"text-sm text-gray-700 space-y-1 d-block d-lg-none"},Ae={class:"mb-0"},De={key:0},$e={class:"comments-section mt-4"},Ce={class:"comment-form__header"},Ne={class:"comment-form__input-group"},Pe=["disabled"],Ve={key:0,class:"comments-list"},je={class:"comment-card__header"},Le=["src"],Se={class:"text-dark",style:{width:"200px"}},Fe={class:"comment-card__meta"},Ue={class:"comment-card__date"},Me={key:0,class:"comment-card__actions"},Ee=["onClick","aria-expanded"],Re={key:0,class:"comment-card__dropdown"},Be=["onClick"],Oe={class:"comment-card__content"},We={class:"comment-card__text"},He={key:1,class:"comments-empty"},ze={key:1},Ge={class:"modal fade",id:"fullView",tabindex:"-1","aria-labelledby":"fullViewLabel","aria-hidden":"true"},Te={class:"modal-dialog"},qe={class:"modal-content"},Je={class:"modal-body"},Ke=["src"],Qe={__name:"ViewItemInfo",props:{item:{type:Object,default:()=>({})},created_by:{type:Object,default:()=>({})},profile:{type:String,default:""},comments:{type:Array,default:()=>[]},currentUser:{type:Number,default:null}},setup(P){var w,k;const m=P;B();const i=c(null),o=c({}),h=c(""),n=c([]),V=c();let _=c(!1);I(()=>{var s;return(s=m.created_by)==null?void 0:s.id},s=>{V.value=s},{immediate:!0}),I(()=>m.item,s=>{o.value=s},{immediate:!0}),I(()=>m.profile,s=>{h.value=s},{immediate:!0}),I(()=>m.comments,s=>{n.value=s,console.log("comments: ",n.value)},{immediate:!0}),I(()=>m.currentUser,s=>{i.value=s},{immediate:!0});const f=G({user_id:String(((w=m.created_by)==null?void 0:w.id)||""),item_id:String(((k=m.item)==null?void 0:k.id)||""),content:""}),A=()=>{var s;f.post(route("comment.store",{item:(s=o==null?void 0:o.value)==null?void 0:s.id}),{onSuccess:()=>{f.reset("content"),console.log("form => ",f)},onError:t=>{console.error("an error occured => ",t)}})},D=s=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString(void 0,t)},x=c(null),u=s=>{x.value=x.value===s?null:s},p=s=>{Y.Inertia.delete(route("comment.delete",{id:s}),{onSuccess:()=>{alert("called "),n.value=n==null?void 0:n.value.filter(t=>t.id!=s)},onError:t=>{alert("an error occured while deleting data => ",t)}}),n.value=n==null?void 0:n.value.filter(t=>t.id!=s)},$=s=>{const t="../../images/profile.jpeg";return s?s.startsWith("http://")||s.startsWith("https://")?s:`/storage/${s}`:t};return(s,t)=>{const O=T("click-outside");return r(),a(E,null,[y(v(q),{title:"View Item Info"}),y(X,null,{default:N(()=>[e("div",fe,[e("div",ve,[e("div",pe,[Object.keys(o.value).length>0?(r(),a("div",be,[y(_e,{created_by:m.created_by,getProfile:h.value,data:o.value,title:o.value.title,description:o.value.description},null,8,["created_by","getProfile","data","title","description"]),e("div",{class:"relative mb-6",onMouseenter:t[0]||(t[0]=l=>U(_)?_.value=!0:_=!0),onMouseleave:t[1]||(t[1]=l=>U(_)?_.value=!1:_=!1)},[e("img",{src:o.value.image_url,alt:"Item Image",class:"rounded object-cover image-item"},null,8,ge),v(_)?(r(),a("button",ye," Full View ")):b("",!0)],32),e("div",he,d(D(o.value.reported_at)),1),e("div",xe,[e("p",we,[t[3]||(t[3]=e("i",{class:"bi bi-geo-alt-fill me-2 text-dark"},null,-1)),g(d(o.value.location),1)]),e("p",null,[t[4]||(t[4]=e("i",{class:"bi bi-telephone-fill me-2 text-dark"},null,-1)),g(d(o.value.owner_phone_number||"NA"),1)]),o.value.category?(r(),a("p",ke,[t[5]||(t[5]=e("i",{class:"bi bi-tags-fill me-2 text-dark"},null,-1)),g(d(o.value.category||"NA"),1)])):b("",!0),e("p",null,[e("i",{class:j(["bi me-2",o.value.status==="Lost"?"bi-x-circle-fill text-danger":"bi-check-circle-fill text-success"])},null,2),e("span",{class:j(o.value.status==="Lost"?"text-red-600 font-semibold":"text-green-600")},d(o.value.status),3)])]),e("div",Ie,[e("p",Ae,[t[6]||(t[6]=e("i",{class:"bi bi-geo-alt-fill me-2"},null,-1)),g(d(o.value.location),1)]),e("p",null,[t[7]||(t[7]=e("i",{class:"bi bi-telephone-fill me-2"},null,-1)),g(" "+d(o.value.owner_phone_number||"NA"),1)]),o.value.category?(r(),a("p",De,[t[8]||(t[8]=e("i",{class:"bi bi-bookmark-fill me-2"},null,-1)),g(d(o.value.category||"NA"),1)])):b("",!0),e("p",null,[t[9]||(t[9]=e("i",{class:"bi bi-info-circle-fill me-2"},null,-1)),e("span",{class:j(o.value.status==="Lost"?"text-red-600 font-semibold":"text-green-600")},d(o.value.status),3)])]),e("div",$e,[e("form",{onSubmit:J(A,["prevent"]),class:"comment-form"},[e("div",Ce,[t[11]||(t[11]=e("div",{class:"comment-form__avatar"},null,-1)),e("div",Ne,[M(e("input",{type:"text",class:"comment-form__input","onUpdate:modelValue":t[2]||(t[2]=l=>v(f).content=l),placeholder:"Write a comment...",maxlength:"500"},null,512),[[K,v(f).content]]),e("button",{class:"comment-form__submit",type:"submit",disabled:!v(f).content.trim()},t[10]||(t[10]=[e("i",{class:"bi bi-send-fill"},null,-1),e("span",null,"Post",-1)]),8,Pe)])])],32),n.value&&n.value.length>0?(r(),a("div",Ve,[(r(!0),a(E,null,Q(n.value,l=>{var S;return r(),a("div",{class:"comment-card",key:l.id},[e("div",je,[y(v(L),{href:s.route("view.userAsUser",{id:(S=l==null?void 0:l.user)==null?void 0:S.id}),class:"comment-card__user text-decoration-none"},{default:N(()=>{var C,F;return[e("img",{src:$((C=l==null?void 0:l.user_info)==null?void 0:C.profile_pic),alt:"User profile",class:"comment-card__avatar"},null,8,Le),e("span",Se,d(((F=l==null?void 0:l.user)==null?void 0:F.name)||"user"),1)]}),_:2},1032,["href"]),e("div",Fe,[e("time",Ue,d(D(l.created_at)||"No date available"),1),(l==null?void 0:l.user_id)==i.value?(r(),a("div",Me,[e("button",{class:"comment-card__action-btn",onClick:C=>u(l.id),"aria-expanded":x.value===l.id,"aria-label":"Comment options"},t[12]||(t[12]=[e("i",{class:"bi bi-three-dots-vertical"},null,-1)]),8,Ee),x.value===l.id?M((r(),a("div",Re,[e("button",{class:"comment-card__dropdown-item comment-card__dropdown-item--delete",onClick:C=>p(l.id)},t[13]||(t[13]=[e("i",{class:"bi bi-trash"},null,-1),e("span",null,"Delete Comment",-1)]),8,Be)])),[[O,s.closeActionMenu]]):b("",!0)])):b("",!0)])]),e("div",Oe,[e("p",We,d(l.content||"No content"),1)])])}),128))])):n.value?(r(),a("div",He,t[14]||(t[14]=[e("div",{class:"comments-empty__icon"},[e("i",{class:"bi bi-chat-left"})],-1),e("p",{class:"comments-empty__text"},"No comments yet",-1),e("p",{class:"comments-empty__subtext"},"Be the first to share your thoughts!",-1)]))):b("",!0)])])):(r(),a("div",ze,t[15]||(t[15]=[e("p",null,"Loading item details...",-1)])))])])]),e("div",Ge,[e("div",Te,[e("div",qe,[t[16]||(t[16]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"fullView"},"Full image"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Je,[e("img",{src:o.value.image_url,alt:"Image",class:"mx-auto"},null,8,Ke)])])])])]),_:1})],64)}}},nt=R(Qe,[["__scopeId","data-v-a6ebc4ae"]]);export{nt as default};
