import{_ as N,r as i,j as y,c as o,o as a,h as m,i as W,b as e,e as B,W as f,n as h,l as J,y as Q,G as X,a as A,u as P,m as Y,k as q,A as H,I as K,F as I,s as T,J as Z,d as ee,t as $}from"./app-BVOfK1M-.js";const se={class:"list"},te={__name:"PopupForViewMoreUsers",props:{show:Boolean,id:Number,position:Object,isBlocked:Boolean},setup(g,{expose:k}){const d=g,n=i(!1),c=i(null),r=i(0),v=i(!1);y(()=>d.show,u=>{n.value=u},{immediate:!0}),y(()=>d.id,u=>{r.value=u},{immediate:!0}),y(()=>d.isBlocked,u=>{v.value=u},{immediate:!0}),k({root:c});const C=()=>{n.value=!1,f.post(route("message.block",{id:r.value}),{},{onError:()=>alert("Something went wrong, please try again."),onSuccess:()=>{f.visit(route("viewMoreUsers.index",{id:r.value}))}})},S=()=>{n.value=!1,f.delete(route("viewMoreUsers.unBlock",{id:r.value}),{},{onError:()=>alert("Something went wrong, please try again."),onSuccess:()=>{f.visit(route("viewMoreUsers.index",{id:r.value}))}})},M=()=>{f.visit(route("message.viewChat",{id:r.value}))};return(u,p)=>(a(),o("div",{ref_key:"root",ref:c},[n.value?(a(),o("div",{key:0,class:"action-container",style:W({top:`${g.position.top}px`,left:`${g.position.left}px`})},[e("div",se,[v.value?m("",!0):(a(),o("button",{key:0,type:"button",class:"d-flex align-items-center gap-2 w-100",onClick:C},p[0]||(p[0]=[e("i",{class:"bi bi-ban"},null,-1),B(" Block ")]))),v.value?(a(),o("button",{key:1,type:"button",class:"d-flex align-items-center gap-2 w-100",onClick:S},p[1]||(p[1]=[e("i",{class:"bi bi-circle"},null,-1),B(" Unblock ")]))):m("",!0),v.value?m("",!0):(a(),o("button",{key:2,type:"button",class:"d-flex align-items-center gap-2 w-100 mt-2",onClick:M},p[2]||(p[2]=[e("i",{class:"bi bi-chat-dots"},null,-1),B(" Message ")])))])],4)):m("",!0)],512))}},le=N(te,[["__scopeId","data-v-6ad9ceee"]]),oe={class:"container ps-0 sub-header d-flex flex-row align-items-center gap-1 mb-2"},ae={__name:"ToggleAllOrBlocked",props:{status:String},setup(g){const k=g,d=i("all");y(()=>k.status,r=>{d.value=r,console.log("status: ",d.value)},{immediate:!0});const n=()=>{f.visit(route("viewMoreUsers.index"))},c=()=>{f.visit(route("viewMoreUsers.blocked"))};return(r,v)=>(a(),o("div",null,[e("div",oe,[e("div",null,[e("button",{class:h(["button-all",{active:d.value=="all"}]),onClick:n},"All",2)]),e("div",null,[e("button",{class:h(["button-blocked",{active:d.value=="blocked"}]),onClick:c},"Blocked",2)])])]))}},ie=N(ae,[["__scopeId","data-v-cbdac3bd"]]),ne={class:"p-4 rounded users-container d-flex flex-row justify-content-center align-items-center pt-3"},de={class:"container rounded"},re={class:"header-container container-fluid py-3 d-flex justify-content-between mb-3"},ce={class:"w-50"},ue={key:0,class:"fw-bold all-users-text"},ve={key:1,class:"fw-bold all-users-text"},pe={class:"input-group d-flex justify-content-end search-container"},me=["disabled"],ge=["disabled"],fe={key:0,class:"loading-container"},ke={class:"skeleton-loading"},be={class:"skeleton-table"},_e={key:1,class:"table-wrapper"},he={class:"table table-responsive align-middle"},ye={class:"d-flex flex-row gap-2 align-items-center"},we={class:"position-relative"},xe=["src"],Be={key:0,class:"loading-overlay"},Ue={key:0,class:"text-danger"},Ce={class:"ps-4"},Se={class:"action-container position-relative"},Me=["onClick","disabled"],Le={key:0,class:"action-loading"},Ve={key:0},Ae={colspan:"3",class:"text-center border-0"},Ie=["disabled"],Ne={key:0,class:"d-flex align-items-center justify-content-center"},je={key:1},Ee={key:2,class:"text-muted"},Pe={key:1},O=10,Te={__name:"ViewMoreUsers",props:{users:Array,blocked_users:Array,toggleStatus:String},setup(g){const k=g;let d=i([]);const n=i([]);let c=i(""),r=i("");const v=i(!1),C=i(null),S=i(0),M=i({top:0,left:0}),u=i(!1),p=i("all");let j=i(0);const w=i(!1),b=i(!0),L=i(!0),x=i({});y(()=>k.users,l=>{d.value=l,b.value=!1},{immediate:!0}),y(()=>k.blocked_users,l=>{n.value=l},{immediate:!0}),y(()=>k.toggleStatus,l=>{p.value=l},{immediate:!0});const V=J(()=>{let l=d.value;return c.value.trim()!==""&&(l=l.filter(s=>s.name.toLowerCase().includes(c.value.toLowerCase()))),r.value==="name"?l=[...l].sort((s,t)=>s.name.localeCompare(t.name)):r.value==="role"&&(l=[...l].sort((s,t)=>s.role.localeCompare(t.role))),l});function R(l,s){const t=s.target.getBoundingClientRect();M.value={top:t.top+window.scrollY+t.height,left:t.left+window.scrollX},n.value.includes(l)?u.value=!0:u.value=!1,S.value=l,v.value=!0}function E(l){var U;const s=(U=C.value)==null?void 0:U.root,t=s==null?void 0:s.contains(l.target),_=l.target.classList.contains("action");!t&&!_&&(v.value=!1)}Q(()=>{document.addEventListener("click",E),setTimeout(()=>{b.value=!1},800)}),X(()=>{document.removeEventListener("click",E)});function F(){f.get(route("message.index"))}async function z(){if(!(w.value||!L.value)){j.value+=O,w.value=!0;try{const l=await Z.get(`/viewMoreUsers/load-more-users/${j.value}`),s=l.data.users,t=l.data.blocked_users;s.length<O&&(L.value=!1),d.value=[...d.value,...s],t.forEach(_=>{n.value.includes(_)||n.value.push(_)})}catch(l){console.error("Error loading more users:",l)}finally{w.value=!1}}}function D(l,s){x.value[l]=s}return(l,s)=>(a(),o(I,null,[A(P(Y),{title:"view more users"}),e("div",ne,[e("div",de,[e("div",re,[e("div",ce,[g.toggleStatus=="all"?(a(),o("h2",ue,"All users")):(a(),o("h2",ve,"Blocked users"))]),e("div",pe,[e("button",{onClick:F,class:"fs-5 me-3 btn btn-light",disabled:b.value},s[1]||(s[1]=[e("i",{class:"bi bi-caret-left"},null,-1),B(" Go Back ")]),8,me),s[2]||(s[2]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),q(e("input",{type:"text",class:"form-control search",placeholder:"Search by name...","onUpdate:modelValue":s[0]||(s[0]=t=>K(c)?c.value=t:c=t),disabled:b.value},null,8,ge),[[H,P(c)]])])]),A(ie,{status:p.value,disabled:b.value},null,8,["status","disabled"]),b.value?(a(),o("div",fe,[e("div",ke,[s[4]||(s[4]=e("div",{class:"skeleton-header mb-3"},[e("div",{class:"skeleton-line skeleton-title"})],-1)),e("div",be,[(a(),o(I,null,T(5,t=>e("div",{class:"skeleton-row",key:t},s[3]||(s[3]=[ee('<div class="skeleton-cell" data-v-374d3a8c><div class="skeleton-avatar" data-v-374d3a8c></div><div class="skeleton-text-container" data-v-374d3a8c><div class="skeleton-text skeleton-name" data-v-374d3a8c></div><div class="skeleton-text skeleton-email" data-v-374d3a8c></div></div></div><div class="skeleton-cell" data-v-374d3a8c><div class="skeleton-text skeleton-email-full" data-v-374d3a8c></div></div><div class="skeleton-cell" data-v-374d3a8c><div class="skeleton-action" data-v-374d3a8c></div></div>',3)]))),64))])])])):(a(),o("div",_e,[e("table",he,[s[9]||(s[9]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Users Name"),e("th",null,"Email"),e("th",null,"Action")])],-1)),e("tbody",null,[(a(!0),o(I,null,T(V.value,t=>{var _,U;return a(),o("tr",{key:t.id,class:"user-row"},[e("td",ye,[e("div",we,[e("img",{src:(_=t==null?void 0:t.user_info)!=null&&_.profile_pic?`/storage/${(U=t==null?void 0:t.user_info)==null?void 0:U.profile_pic}`:"../../images/profile.jpeg",alt:"Profile",class:h(["profile-pic",{"loading-image":x.value[t.id]}])},null,10,xe),x.value[t.id]?(a(),o("div",Be,s[5]||(s[5]=[e("div",{class:"spinner-border spinner-border-sm",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):m("",!0)]),e("div",{class:h({"text-muted":n.value.includes(t.id)})},[B($(t.name)+" ",1),n.value.includes(t.id)?(a(),o("span",Ue,"Blocked")):m("",!0)],2)]),e("td",{class:h({"text-muted":n.value.includes(t.id)})},$(t.email),3),e("td",Ce,[e("div",Se,[e("i",{class:h(["bi bi-three-dots action",{"loading-action":x.value[t.id]}]),onClick:G=>R(t.id,G),disabled:x.value[t.id]},null,10,Me),x.value[t.id]?(a(),o("div",Le,s[6]||(s[6]=[e("div",{class:"spinner-border spinner-border-sm",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):m("",!0)]),A(le,{show:v.value,ref_for:!0,ref_key:"popupRef",ref:C,id:S.value,position:M.value,isBlocked:u.value,onLoading:D},null,8,["show","id","position","isBlocked"])])])}),128)),V.value.length>0?(a(),o("tr",Ve,[e("td",Ae,[e("button",{class:h(["btn btn-outline-primary load-more-btn",{loading:w.value}]),onClick:z,disabled:w.value||!L.value},[w.value?(a(),o("span",Ne,s[7]||(s[7]=[e("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),B(" Loading... ")]))):L.value?(a(),o("span",je," Load More Users ")):(a(),o("span",Ee," No more users to load "))],10,Ie)])])):m("",!0),V.value.length===0&&!b.value?(a(),o("tr",Pe,s[8]||(s[8]=[e("td",{colspan:"3",class:"text-center py-5"},[e("div",{class:"empty-state"},[e("i",{class:"bi bi-people display-4 text-muted"}),e("p",{class:"text-muted mt-3"},"No users found")])],-1)]))):m("",!0)])])]))])])],64))}},Oe=N(Te,[["__scopeId","data-v-374d3a8c"]]);export{Oe as default};
