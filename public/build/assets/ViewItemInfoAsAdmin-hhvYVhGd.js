import{_ as O,r as c,y as K,G as Q,c as n,o as a,b as e,a as h,w as $,t as r,u as b,P as H,h as _,W as R,j as x,C as X,ai as Z,m as ee,I as E,e as y,n as N,g as te,k as B,A as se,F as W,s as oe}from"./app-BVOfK1M-.js";import{_ as le}from"./profile-DO1RT1I2.js";import{d as ie}from"./downloadAsPDF-DEr5fmes.js";import{A as ne}from"./AdminLayout-KqewptlA.js";import{d as ae}from"./index-BEMHGnw0.js";import"./lost_and_found_logo-Bi2rL7qL.js";import"./index-09AjRV5V.js";const re={class:"position-relative"},de={class:"d-flex flex-column gap-3 mb-4 header"},ce={class:"container-fluid d-flex flex-row justify-content-between align-items-center px-0"},me={key:0},ue=["src"],_e={class:"text-sm font-medium text-gray-700"},fe={key:1,class:"d-flex align-items-center gap-2 text-muted"},ve={class:"d-flex flex-column w-100"},pe={class:"text-xl font-semibold mb-0"},be={class:"description"},ge={__name:"ViewItemInfoForAdminHeader",props:{id:{type:[Number,String,null],default:null},item_id:Number,profile:String,title:String,description:String,name:String},setup(I){const o=I,f=c(!1),l=c(null),g=c(null),d=()=>{f.value=!f.value},w=u=>{l.value&&!l.value.contains(u.target)&&g.value&&!g.value.contains(u.target)&&(f.value=!1)};K(()=>{document.addEventListener("click",w)}),Q(()=>{document.removeEventListener("click",w)});const m=()=>{if(!o.id){alert("The user no longer exists.");return}const u=`/mark-as-resolve/${o.item_id}/${o.id}`;R.post(u,{},{onSuccess:()=>alert("Item resolved. You can now go back to items."),onError:()=>alert("Something went wrong, please try again.")})},v=()=>{confirm("Are you sure you want to delete this item? ")&&R.delete(route("forceDeleteItem",{id:o.item_id}),{},{onSuccess:()=>alert("Item deleted."),onError:()=>alert("An error occurred, please try again.")})};return console.log("id: ",(o==null?void 0:o.id)||"NA"),console.log("name: ",(o==null?void 0:o.name)||"NA"),(u,p)=>(a(),n("div",re,[e("div",de,[e("div",ce,[o.id?(a(),n("div",me,[h(b(H),{href:u.route("viewUserAsAdmin",{id:o.id}),class:"text-decoration-none d-flex align-items-center justify-content-end gap-2"},{default:$(()=>[e("img",{src:o.profile==="NA"?"../../../images/profile.jpeg":`/storage/${o.profile}`,alt:"User",class:"profile-pic rounded-full"},null,8,ue),e("span",_e,r(o.name),1)]),_:1},8,["href"])])):(a(),n("div",fe,p[0]||(p[0]=[e("img",{src:le,alt:"User",class:"profile-pic rounded-full"},null,-1),e("span",{class:"text-sm font-medium"},"Deleted User",-1)]))),e("div",{ref_key:"iconRef",ref:g,class:"position-relative"},[e("i",{class:"bi bi-three-dots-vertical action",onClick:d}),f.value?(a(),n("div",{key:0,ref_key:"popupRef",ref:l,class:"position-absolute bg-white border shadow-sm rounded d-flex flex-column",style:{right:"10%",top:"100%","z-index":"999","min-width":"200px"}},[e("button",{class:"button mb-2",onClick:m},"Mark as Resolve"),e("button",{class:"button",onClick:v,title:"Note! only if the user didn't follow the privacy and policy."},"Force Delete"),p[1]||(p[1]=e("button",{class:"button","data-bs-toggle":"modal","data-bs-target":"#downloadAsPDF"},"Download as PDF",-1))],512)):_("",!0)],512)]),e("div",ve,[e("h2",pe,r(o.title||"Unnamed Item"),1),e("p",be,r(o.description||"No description"),1)])])]))}},ye=O(ge,[["__scopeId","data-v-5cfc3092"]]),he={class:"main-container"},xe={class:"container"},we={class:"post-container rounded-lg"},ke={key:0},Ae=["src"],Ie={key:0,class:"absolute inset-0 bg-black bg-opacity-50 text-white font-semibold transition-opacity duration-300 flex items-center justify-center rounded","data-bs-toggle":"modal","data-bs-target":"#fullView"},De={class:"text-end date"},Ne={class:"text-sm text-gray-700 space-y-1 d-none d-lg-block"},$e={class:"mb-0"},Ce={key:0},Se={class:"text-sm text-gray-700 space-y-1 d-block d-lg-none"},Fe={class:"mb-0"},Ve={key:0},Le={class:"comments-section mt-4"},Ue={class:"comment-form__header"},je={class:"comment-form__input-group"},Me=["disabled"],Pe={key:0,class:"comments-list"},Re={class:"comment-card__header"},Ee=["src"],Be={class:"text-dark",style:{width:"200px"}},We={class:"comment-card__meta"},Oe={class:"comment-card__date"},He={key:0,class:"comment-card__actions"},Te=["onClick","aria-expanded"],ze={key:0,class:"comment-card__dropdown"},Ge=["onClick"],Ye={class:"comment-card__content"},qe={class:"comment-card__text"},Je={key:1,class:"comments-empty"},Ke={key:1},Qe={class:"modal fade",id:"downloadAsPDF",tabindex:"-1","aria-labelledby":"addNewMemberLabel","aria-hidden":"true"},Xe={class:"modal-dialog modal-lg"},Ze={class:"modal-content"},et={class:"modal-body"},tt={key:0,class:"loading-overlay"},st={class:"loading-box"},ot={class:"modal fade",id:"fullView",tabindex:"-1","aria-labelledby":"fullViewLabel","aria-hidden":"true"},lt={class:"modal-dialog"},it={class:"modal-content"},nt={class:"modal-body"},at=["src"],rt={__name:"ViewItemInfoAsAdmin",props:{item:{type:Object,default:()=>({})},created_by:{type:Object,default:()=>({})},profile:{type:String,default:""},comments:{type:Array,default:()=>[]},currentUser:{type:Number,default:null}},setup(I){var S,F;const o=I,f=c(null),l=c({}),g=c(""),d=c([]),w=c();let m=c(!1);x(()=>{var s;return(s=o.created_by)==null?void 0:s.id},s=>{w.value=s},{immediate:!0}),x(()=>o.item,s=>{l.value=s},{immediate:!0}),x(()=>o.profile,s=>{g.value=s},{immediate:!0}),x(()=>o.comments,s=>{d.value=s},{immediate:!0}),x(()=>o.currentUser,s=>{f.value=s},{immediate:!0});const v=X({user_id:String(((S=o.created_by)==null?void 0:S.id)||""),item_id:String(((F=o.item)==null?void 0:F.id)||""),content:""}),u=()=>{var s;v.post(route("comment.store",{item:(s=l==null?void 0:l.value)==null?void 0:s.id}),{onSuccess:()=>{v.reset("content")},onError:()=>{alert("Something went wrong, please try again.")}})},p=s=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString(void 0,t)},k=c(null),T=s=>{k.value=k.value===s?null:s},z=s=>{ae.Inertia.delete(route("comment.delete",{id:s}),{onSuccess:()=>{d.value=d==null?void 0:d.value.filter(t=>t.id!=s)},onError:t=>{alert("An error occurred while deleting data => ",t)}}),d.value=d==null?void 0:d.value.filter(t=>t.id!=s)},D=c(!1),G=c("Generating PDF, please wait..."),C=c(null),Y=async()=>{try{D.value=!0,await C.value.downloadPdf()}catch(s){console.error(s),alert("PDF download failed!")}finally{D.value=!1}},q=s=>{const t="../../../images/profile.jpeg";return s?s.startsWith("http://")||s.startsWith("https://")?s:`/storage/${s}`:t};return(s,t)=>{const J=Z("click-outside");return a(),n(W,null,[h(b(ee),{title:"View Item Info"}),h(ne,null,{default:$(()=>{var V,L,U,j;return[e("div",he,[e("div",xe,[e("div",we,[Object.keys(l.value).length>0?(a(),n("div",ke,[h(ye,{id:((V=o==null?void 0:o.created_by)==null?void 0:V.id)||null,item_id:o==null?void 0:o.item.id,name:(L=o==null?void 0:o.created_by)==null?void 0:L.name,title:(U=l.value)==null?void 0:U.title,description:(j=l.value)==null?void 0:j.description,profile:g.value},null,8,["id","item_id","name","title","description","profile"]),e("div",{class:"relative mb-6",onMouseenter:t[0]||(t[0]=i=>E(m)?m.value=!0:m=!0),onMouseleave:t[1]||(t[1]=i=>E(m)?m.value=!1:m=!1)},[e("img",{src:l.value.image_url,alt:"Item Image",class:"rounded object-cover image-item"},null,8,Ae),b(m)?(a(),n("button",Ie," Full View ")):_("",!0)],32),e("div",De,r(p(l.value.reported_at)),1),e("div",Ne,[e("p",$e,[t[3]||(t[3]=e("i",{class:"bi bi-geo-alt-fill me-2 text-dark"},null,-1)),y(r(l.value.location),1)]),e("p",null,[t[4]||(t[4]=e("i",{class:"bi bi-telephone-fill me-2 text-dark"},null,-1)),y(r(l.value.owner_phone_number||"NA"),1)]),l.value.category?(a(),n("p",Ce,[t[5]||(t[5]=e("i",{class:"bi bi-tags-fill me-2 text-dark"},null,-1)),y(r(l.value.category||"NA"),1)])):_("",!0),e("p",null,[e("i",{class:N(["bi me-2",l.value.status==="Lost"?"bi-x-circle-fill text-danger":"bi-check-circle-fill text-success"])},null,2),e("span",{class:N(l.value.status==="Lost"?"text-red-600 font-semibold":"text-green-600")},r(l.value.status),3)])]),e("div",Se,[e("p",Fe,[t[6]||(t[6]=e("i",{class:"bi bi-geo-alt-fill me-2"},null,-1)),y(r(l.value.location),1)]),e("p",null,[t[7]||(t[7]=e("i",{class:"bi bi-telephone-fill me-2"},null,-1)),y(" "+r(l.value.owner_phone_number||"NA"),1)]),l.value.category?(a(),n("p",Ve,[t[8]||(t[8]=e("i",{class:"bi bi-bookmark-fill me-2"},null,-1)),y(r(l.value.category||"NA"),1)])):_("",!0),e("p",null,[t[9]||(t[9]=e("i",{class:"bi bi-info-circle-fill me-2"},null,-1)),e("span",{class:N(l.value.status==="Lost"?"text-red-600 font-semibold":"text-green-600")},r(l.value.status),3)])]),e("div",Le,[e("form",{onSubmit:te(u,["prevent"]),class:"comment-form"},[e("div",Ue,[t[11]||(t[11]=e("div",{class:"comment-form__avatar"},null,-1)),e("div",je,[B(e("input",{type:"text",class:"comment-form__input","onUpdate:modelValue":t[2]||(t[2]=i=>b(v).content=i),placeholder:"Write a comment...",maxlength:"500"},null,512),[[se,b(v).content]]),e("button",{class:"comment-form__submit",type:"submit",disabled:!b(v).content.trim()},t[10]||(t[10]=[e("i",{class:"bi bi-send-fill"},null,-1),e("span",null,"Post",-1)]),8,Me)])])],32),d.value&&d.value.length>0?(a(),n("div",Pe,[(a(!0),n(W,null,oe(d.value,i=>{var M;return a(),n("div",{class:"comment-card",key:i.id},[e("div",Re,[h(b(H),{href:s.route("viewUserAsAdmin",{id:(M=i==null?void 0:i.user)==null?void 0:M.id}),class:"comment-card__user text-decoration-none"},{default:$(()=>{var A,P;return[e("img",{src:q((A=i==null?void 0:i.user_info)==null?void 0:A.profile_pic),alt:"User profile",class:"comment-card__avatar"},null,8,Ee),e("span",Be,r(((P=i==null?void 0:i.user)==null?void 0:P.name)||"user"),1)]}),_:2},1032,["href"]),e("div",We,[e("time",Oe,r(p(i.created_at)||"No date available"),1),(i==null?void 0:i.user_id)==f.value?(a(),n("div",He,[e("button",{class:"comment-card__action-btn",onClick:A=>T(i.id),"aria-expanded":k.value===i.id,"aria-label":"Comment options"},t[12]||(t[12]=[e("i",{class:"bi bi-three-dots-vertical"},null,-1)]),8,Te),k.value===i.id?B((a(),n("div",ze,[e("button",{class:"comment-card__dropdown-item comment-card__dropdown-item--delete",onClick:A=>z(i.id)},t[13]||(t[13]=[e("i",{class:"bi bi-trash"},null,-1),e("span",null,"Delete Comment",-1)]),8,Ge)])),[[J,s.closeActionMenu]]):_("",!0)])):_("",!0)])]),e("div",Ye,[e("p",qe,r(i.content||"No content"),1)])])}),128))])):d.value?(a(),n("div",Je,t[14]||(t[14]=[e("div",{class:"comments-empty__icon"},[e("i",{class:"bi bi-chat-left"})],-1),e("p",{class:"comments-empty__text"},"No comments yet",-1),e("p",{class:"comments-empty__subtext"},"Be the first to share your thoughts!",-1)]))):_("",!0)])])):(a(),n("div",Ke,t[15]||(t[15]=[e("p",null,"Loading item details...",-1)]))),e("div",Qe,[e("div",Xe,[e("div",Ze,[e("div",et,[h(ie,{ref_key:"pdfRef",ref:C,item:l.value},null,8,["item"])]),e("div",{class:"modal-footer"},[t[16]||(t[16]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:Y}," Download now ")])])])])])])]),D.value?(a(),n("div",tt,[e("div",st,[t[17]||(t[17]=e("div",{class:"spinner"},null,-1)),e("p",null,r(G.value),1)])])):_("",!0),e("div",ot,[e("div",lt,[e("div",it,[t[18]||(t[18]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"fullView"},"Full image"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",nt,[e("img",{src:l.value.image_url,alt:"Image",class:"mx-auto"},null,8,at)])])])])]}),_:1})],64)}}},pt=O(rt,[["__scopeId","data-v-89504d8e"]]);export{pt as default};
